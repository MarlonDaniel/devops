FROM mariadb
EXPOSE 8080 3306
ARG MYSQL_ROOT_PASSWORD
ENV MYSQL_ROOT_PASSWORD=${MYSQL_ROOT_PASSWORD}
#WORKDIR /etc/init.d
#RUN mysql start
RUN mysql -u root --password=${MYSQL_ROOT_PASSWORD} -e "CREATE DATABASE moodle DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"
RUN mysql -u root --password=${MYSQL_ROOT_PASSWORD} -e "GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,CREATE TEMPORARY TABLES,DROP,INDEX,ALTER ON moodle.* TO 'moodleuser'@' 127.0.0.1' IDENTIFIED BY 'yourpassword';"